
Of course. The Gray-Scott model is a beautiful example of how simple rules can lead to complex, life-like patterns. This script will implement the model from scratch using vectorized R operations for efficiency.

Below is a complete, self-contained R script that simulates the Gray-Scott reaction-diffusion system and produces the desired "coral-like" pattern.

---

### R Script for Turing Pattern (Gray-Scott Model)

```r
# --------------------------------------------------------------
# 1.  Load Required Libraries
# --------------------------------------------------------------
library(ggplot2)
library(viridis) # For the viridis color scale

# --------------------------------------------------------------
# 2.  Define Simulation Parameters
# --------------------------------------------------------------
# Grid dimensions
grid_size <- 100

# Model parameters (The "Coral" preset)
Du <- 0.16   # Diffusion rate for U
Dv <- 0.08   # Diffusion rate for V
F  <- 0.035  # Feed rate
k  <- 0.060  # Kill rate

# Simulation settings
n_iterations <- 2000

# Time step (dt=1.0 is standard and stable for these parameters)
dt <- 1.0

# --------------------------------------------------------------
# 3.  Initialize Chemical Concentrations
# --------------------------------------------------------------

# Create two matrices for chemicals U and V, initialized to zero
U <- matrix(0, nrow = grid_size, ncol = grid_size)
V <- matrix(0, nrow = grid_size, ncol = grid_size)

# Set initial conditions: U=1, V=0 everywhere
U[] <- 1

# Add a seed of V in the center to kick-start the reaction
# The prompt specifies a 10x10 square where V=1
seed_size <- 10
center <- grid_size / 2
x_start <- center - seed_size / 2
x_end <- center + seed_size / 2

# Set V=1 in the central square
V[x_start:x_end, x_start:x_end] <- 1

# Note: Adding small random noise instead of a solid square is also a common
# seeding strategy, e.g., V[x_start:x_end, x_start:x_end] <- runif(seed_size^2)

# --------------------------------------------------------------
# 4.  The Simulation Loop
# --------------------------------------------------------------

cat("Starting Gray-Scott simulation...\n")
pb <- txtProgressBar(min = 0, max = n_iterations, style = 3)

for (i in 1:n_iterations) {
  
  # --- Calculate the Laplacian (∇²) using a 5-point stencil ---
  # We use vectorized matrix shifts for efficiency.
  # Zero-flux boundary conditions are implemented by padding the edges
  # with the edge values themselves (e.g., rbind(U[-1,], U[nrow(U),])).
  
  # Laplacian for U
  lap_U <- (
    rbind(U[-1, ], U[nrow(U), ]) +      # Shift down (U(x+1, y))
    rbind(U[1, ], U[-nrow(U), ]) +      # Shift up (U(x-1, y))
    cbind(U[, -1], U[, 1]) +            # Shift right (U(x, y+1))
    cbind(U[, 1], U[, -1]) -            # Shift left (U(x, y-1))
    4 * U                               # Center point
  )
  
  # Laplacian for V
  lap_V <- (
    rbind(V[-1, ], V[nrow(V), ]) +
    rbind(V[1, ], V[-nrow(V), ]) +
    cbind(V[, -1], V[, 1]) +
    cbind(V[, 1], V[, -1]) -
    4 * V
  )
  
  # --- Calculate the reaction terms ---
  UVV <- U * V^2
  
  # --- Update concentrations using Forward Euler method ---
  # U_new = U_old + dt * (Du * lap_U - UVV + F * (1 - U))
  # V_new = V_old + dt * (Dv * lap_V + UVV - (F + k) * V)
  
  U <- U + dt * (Du * lap_U - UVV + F * (1 - U))
  V <- V + dt * (Dv * lap_V + UVV - (F + k) * V)
  
  # Ensure concentrations stay within physical bounds [0, 1]
  U[U < 0] <- 0
  U[U > 1] <- 1
  V[V < 0] <- 0
  V[V > 1] <- 1
  
  setTxtProgressBar(pb, i)
}
close(pb)
cat("\nSimulation finished.\n")

# --------------------------------------------------------------
# 5.  Prepare Data for Plotting
# --------------------------------------------------------------

# Convert the final V matrix to a long data frame for ggplot2
plot_df <- expand.grid(
  x = 1:grid_size,
  y = 1:grid_size
) %>%
  mutate(
    concentration = as.vector(V)
  )

# --------------------------------------------------------------
# 6.  Create the Final Plot
# --------------------------------------------------------------

p <- ggplot(plot_df, aes(x = x, y = y, fill = concentration)) +
  geom_raster() +
  scale_fill_viridis_c(
    name = "V Concentration",
    option = "D", # D is a good option for this kind of data
    direction = -1 # Invert for dark spots on light background
  ) +
  labs(
    title = "Turing Pattern from Gray-Scott Model",
    subtitle = sprintf("Parameters: F=%.3f, k=%.3f, Iterations=%d", F, k, n_iterations),
    x = "X-coordinate",
    y = "Y-coordinate"
  ) +
  coord_fixed() + # Ensures the grid cells are square
  theme_minimal(base_size = 15) +
  theme(
    legend.position = "right",
    panel.grid = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank()
  )

# Display the plot
print(p)

# --------------------------------------------------------------
# 7.  Save the High-Resolution Plot
# --------------------------------------------------------------
ggsave(
  filename = "Turing_Pattern_Coral.png",
  plot = p,
  width = 8, height = 8, dpi = 300
)

cat("High-resolution plot saved to 'Turing_Pattern_Coral.png'\n")
```

### How to Run and What to Expect

1.  **Install Packages:** If you don't have them, install the required packages.
    ```r
    install.packages(c("ggplot2", "viridis"))
    ```
2.  **Run the Script:** Copy the entire script into your R console or an R file and run it.
3.  **Output:**
    *   The script will print a progress bar in the console as the simulation runs. This can take a minute or two depending on your computer's speed.
    *   Once finished, it will display the final plot of the `V` chemical concentration in the RStudio viewer.
    *   A high-resolution (300 DPI) PNG file named `Turing_Pattern_Coral.png` will be saved in your working directory.

The resulting image will show a complex, organic, and static pattern. You will see intricate, branching structures and spots that resemble coral, fingerprints, or animal skins—exactly the emergent behavior characteristic of the Gray-Scott model with these parameters. The dark areas represent high concentrations of chemical `V`, while the bright areas represent low concentrations.