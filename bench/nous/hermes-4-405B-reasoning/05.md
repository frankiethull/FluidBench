Here's an R script implementing Rayleigh-Bénard convection with Boussinesq approximation:

```r
# Rayleigh-Bénard Convection Simulation
library(ggplot2)
library(grid)

# Simulation Parameters
nx <- 40        # Grid size (x)
ny <- 20        # Grid size (y)
t_max <- 500    # Time steps
dt <- 0.1       # Time step size
dx <- 1.0       # Spatial step size

# Physical Parameters
Pr <- 0.71      # Prandtl number (air)
Ra <- 10000     # Rayleigh number
alpha <- 1.0    # Thermal expansion coefficient
g <- 9.81       # Gravity

# Initialize fields
T <- matrix(0, nrow = nx, ncol = ny)  # Temperature
u <- matrix(0, nrow = nx, ncol = ny)  # X-velocity
v <- matrix(0, nrow = nx, ncol = ny)  # Y-velocity
p <- matrix(0, nrow = nx, ncol = ny)  # Pressure

# Boundary Conditions
T[, 1] <- 1.0   # Bottom wall (hot)
T[, ny] <- 0.0  # Top wall (cold)
u[, c(1, ny)] <- 0  # No-slip at top/bottom
v[, c(1, ny)] <- 0  # No-slip at top/bottom

# Boussinesq buoyancy force
buoyancy_force <- function(T, alpha, g) {
    return(alpha * g * T)
}

# Projection method for incompressible flow
project <- function(u, v) {
    # Calculate divergence
    div <- diff(c(u, u[,1]), dim = 1) + diff(c(v, v[1,]), dim = 2)
    
    # Solve pressure Poisson equation (simplified)
    p <- solve_poisson(div)
    
    # Project velocity to divergence-free
    u <- u - diff(c(p, p[,1]), dim = 1)
    v <- v - diff(c(p, p[1,]), dim = 2)
    
    return(list(u = u, v = v))
}

# Simplified Poisson solver (Jacobi method)
solve_poisson <- function(div) {
    p <- matrix(0, nrow = nx, ncol = ny)
    for (iter in 1:20) {
        p <- (diff(c(p, p[,1]), dim = 1) + diff(c(p, p[1,]), dim = 2) - div) / 4
    }
    return(p)
}

# Main Simulation Loop
for (t in 1:t_max) {
    # Calculate buoyancy force
    Fy <- buoyancy_force(T, alpha, g)
    
    # Update velocity (temporary)
    u_star <- u + (diff(c(u, u[,1]), dim = 1) + diff(c(u, u[1,]), dim = 2)) * dt
    v_star <- v + (diff(c(v, v[,1]), dim = 1) + diff(c(v, v[1,]), dim = 2) + Fy) * dt
    
    # Project to divergence-free
    result <- project(u_star, v_star)
    u <- result$u
    v <- result$v
    
    # Update temperature
    T <- T + (-u * diff(c(T, T[,1]), dim = 1) - 
              v * diff(c(T, T[1,]), dim = 2) + 
              (diff(c(T, T[,1]), dim = 1, differences = 2) + 
               diff(c(T, T[1,]), dim = 2, differences = 2))) * dt
    
    # Apply boundary conditions
    T[, 1] <- 1.0; T[, ny] <- 0.0
    u[, c(1, ny)] <- 0; v[, c(1, ny)] <- 0
}

# Prepare data for plotting
df_temp <- expand.grid(x = 1:nx, y = 1:ny)
df_temp$T <- as.vector(T)

# Create quiver plot data (subsampled)
sub <- seq(1, nx, by = 2)
df_vec <- expand.grid(x = sub, y = sub)
df_vec$u <- as.vector(u[sub, sub])
df_vec$v <- as.vector(v[sub, sub])

# Create combined plot
ggplot() +
    geom_raster(data = df_temp, aes(x, y, fill = T), interpolate = TRUE) +
    scale_fill_gradient2(low = "blue", mid = "white", high = "red", 
                        midpoint = 0.5, limits = c(0, 1)) +
    geom_segment(data = df_vec, 
                 aes(x = x, y = y, xend = x + u, yend = y + v),
                 arrow = arrow(length = unit(0.1, "cm")), 
                 color = "black", size = 0.5) +
    labs(title = "Rayleigh-Bénard Convection",
         x = "X Position", y = "Y Position",
         fill = "Temperature") +
    theme_minimal()
```

**Key Components Explained:**

1. **Physics Model:**
   - Boussinesq approximation for buoyancy
   - Rayleigh number (Ra=10000) controls convection strength
   - Temperature-dependent density variations

2. **Numerical Methods:**
   - Projection method for incompressible flow
   - Simplified Poisson solver for pressure
   - Explicit time-stepping for velocity and temperature

3. **Boundary Conditions:**
   - Hot bottom wall (T=1)
   - Cold top wall (T=0)
   - No-slip velocity boundaries

4. **Visualization:**
   - Temperature heatmap (blue=cold, red=hot)
   - Velocity vector field overlay
   - Subsampling for clearer vector display
   - Combined plot showing convection rolls

**Expected Output:**
- Distinct convection rolls (circular patterns)
- Hot fluid rising in plumes (red areas)
- Cold fluid sinking (blue areas)
- Counter-rotating circulation cells
- Stable convection pattern formation

**Scientific Background:**
Rayleigh-Bénard convection occurs when a fluid is heated from below, creating density differences that drive fluid motion. The Boussinesq approximation simplifies the equations by assuming density variations only matter in the buoyancy term. The Rayleigh number determines the convection regime - at Ra=10000, we expect well-developed convection rolls. The simulation shows how temperature gradients can drive organized fluid motion in nature.